---
description: Acil durum protokolleri - Kritik hata dÃ¼zeltmeleri iÃ§in sÄ±nÄ±rlÄ± dosya boyutu istisnasÄ± (max +50 satÄ±r)
globs:
  - "**/*.js"
  - "**/*.jsx"
  - "**/*.ts"
  - "**/*.tsx"
  - "**/*.py"
alwaysApply: false
priority: 1
triggers: ['critical_bug_fix', 'security_vulnerability', 'production_error', 'system_crash_prevention']
conditions: ['severity = critical', 'production_impact = high']
file_size_exception: 50
emergency_override: true
mandatory_documentation: true
refactoring_schedule: immediate
depends_on: ['file-size-enforcement.mdc', 'language-rules.mdc']
---

# ACÄ°L DURUM PROTOKOLLERI - CRITICAL OVERRIDE

## TEMEL FELSEFESÄ° - CONTROLLED EXCEPTION

Bu component normal kurallarÄ± geÃ§ersiz kÄ±lma yetkisine sahip tek component'tir. Ancak bu yetki sadece gerÃ§ek acil durumlar iÃ§in kullanÄ±lÄ±r ve sÄ±kÄ± kontroller altÄ±ndadÄ±r. Her istisna mutlaka dokÃ¼mante edilir ve hemen refactoring planlanÄ±r.

## ACÄ°L DURUM TESPÄ°TÄ° - EMERGENCY CLASSIFICATION

### ACÄ°L DURUM KRÄ°TERLERÄ° - STRICT DEFINITIONS

AÅŸaÄŸÄ±daki durumlar gerÃ§ek acil durum sayÄ±lÄ±r ve dosya boyutu kurallarÄ±nda sÄ±nÄ±rlÄ± istisna yapÄ±labilir:

**CRITICAL SEVERITY LEVELS:**
- **SEVERÄ°TY 1**: Sistem tamamen Ã§Ã¶kmÃ¼ÅŸ, kullanÄ±cÄ±lar eriÅŸemiyor
- **SEVERÄ°TY 2**: Kritik iÅŸlevler Ã§alÄ±ÅŸmÄ±yor (payment, authentication)
- **SEVERÄ°TY 3**: GÃ¼venlik aÃ§Ä±ÄŸÄ± tespit edildi, immediate patch gerekli
- **SEVERÄ°TY 4**: Veri kaybÄ± riski var, immediate backup/fix gerekli

```javascript
function classifyEmergency(issue) {
    const emergencyTypes = {
        SYSTEM_CRASH: {
            severity: 1,
            maxLineException: 50,
            timeLimit: '1 hour',
            refactoringDeadline: '24 hours'
        },
        CRITICAL_FUNCTION_DOWN: {
            severity: 2,
            maxLineException: 40,
            timeLimit: '2 hours',
            refactoringDeadline: '48 hours'
        },
        SECURITY_VULNERABILITY: {
            severity: 3,
            maxLineException: 30,
            timeLimit: '4 hours',
            refactoringDeadline: '24 hours'
        },
        DATA_LOSS_RISK: {
            severity: 4,
            maxLineException: 30,
            timeLimit: '6 hours',
            refactoringDeadline: '48 hours'
        }
    };
    
    return determineEmergencyType(issue, emergencyTypes);
}
```

### NON-EMERGENCY EXCLUSIONS - REDDEDILECEK DURUMLAR

AÅŸaÄŸÄ±daki durumlar acil durum sayÄ±lmaz ve normal kurallar uygulanÄ±r:

âŒ **KABUL EDÄ°LMEYEN GEREKÃ‡ELER:**
- "Bu feature Ã§ok Ã¶nemli, hemen yapÄ±lmalÄ±"
- "Deadline yaklaÅŸtÄ±, hÄ±zlÄ± halletmek lazÄ±m"
- "Sadece bir kere olsun, sonra refactor yaparÄ±z"
- "Client bekliyor, acele etmek lazÄ±m"
- "Bug var ama sistem Ã§alÄ±ÅŸÄ±yor"
- "Performance problemi var ama kritik deÄŸil"
- "UI bug'Ä±, gÃ¶rÃ¼nÃ¼m bozuk"

## ACÄ°L DURUM AKTÄ°VASYON PROTOKOLLERÄ°

### PHASE 1: ACÄ°L DURUM DOÄRULAMA
Her acil durum iddiasÄ± titiz ÅŸekilde kontrol edilir:

```javascript
function validateEmergency(userRequest) {
    const validation = {
        isProductionDown: assessProductionStatus(),
        userImpactLevel: calculateUserImpact(),
        businessCriticalityy: assessBusinessImpact(),
        timeToImpact: calculateTimeToResolution(),
        alternativeSolutions: checkForQuickAlternatives()
    };
    
    return validation.isProductionDown && 
           validation.userImpactLevel >= 'high' &&
           validation.businessCriticality >= 'critical';
}
```

**DoÄŸrulama sorularÄ±:**
- Sistem ÅŸu an kullanÄ±cÄ±lar tarafÄ±ndan eriÅŸilemiyor mu?
- Bu sorun para kaybÄ±na veya veri kaybÄ±na neden oluyor mu?
- GÃ¼venlik aÃ§Ä±ÄŸÄ± aktif olarak exploit edilme riski var mÄ±?
- Bu sorunu refactoring sonrasÄ±na bÄ±rakma ÅŸansÄ±mÄ±z yok mu?

### PHASE 2: Ä°STÄ°SNA HESAPLAMA
GerÃ§ek acil durum tespit edilirse, minimum gerekli istisna hesaplanÄ±r:

```javascript
function calculateMinimalException(emergencyType, targetFile) {
    const currentSize = getFileSize(targetFile);
    const fixRequirement = assessFixRequirement();
    
    const exception = {
        maxAdditionalLines: Math.min(
            emergencyType.maxLineException,
            fixRequirement.absoluteMinimum
        ),
        justification: emergencyType.reason,
        refactoringDeadline: emergencyType.refactoringDeadline,
        documentationRequired: true
    };
    
    return exception;
}
```

### PHASE 3: CONTROLLED IMPLEMENTATION
Ä°stisna onaylandÄ±ktan sonra kontrollÃ¼ implementasyon baÅŸlatÄ±lÄ±r:

```javascript
// Emergency implementation protocol
function emergencyImplementation(fix, exception) {
    // Pre-implementation logging
    logEmergencyStart({
        timestamp: Date.now(),
        issue: fix.issue,
        targetFile: fix.targetFile,
        currentSize: getFileSize(fix.targetFile),
        maxException: exception.maxAdditionalLines,
        estimatedAddition: fix.estimatedLines
    });
    
    // Implement with line counting
    const implementationResult = applyFixWithLineTracking(fix);
    
    // Post-implementation validation  
    validateEmergencyCompliance(implementationResult, exception);
    
    // Schedule mandatory refactoring
    scheduleRefactoring(exception.refactoringDeadline);
}
```

## EMERGENCY IMPLEMENTATION LIMITS

### MAXIMUM ADDITIONS BY SEVERITY
Her acil durum tipine gÃ¶re maksimum ekleme limitleri:

```javascript
const EMERGENCY_LIMITS = {
    SYSTEM_CRASH: {
        maxLines: 50,
        examples: [
            "Server crash fix",
            "Database connection restore",
            "Critical API endpoint repair"
        ]
    },
    CRITICAL_FUNCTION_DOWN: {
        maxLines: 40,
        examples: [
            "Payment processor fix",
            "User authentication repair", 
            "Core business logic fix"
        ]
    },
    SECURITY_VULNERABILITY: {
        maxLines: 30,
        examples: [
            "SQL injection patch",
            "Authentication bypass fix",
            "Data exposure prevention"
        ]
    },
    DATA_LOSS_RISK: {
        maxLines: 30,
        examples: [
            "Data corruption prevention",
            "Backup mechanism fix",
            "Transaction rollback repair"
        ]
    }
};
```

### IMPLEMENTATION CONSTRAINTS
Acil durum implementasyonu bile sÄ±nÄ±rlar dahilindedir:

- âœ… **Ä°ZÄ°N VERÄ°LEN**: Minimum gerekli kod ekleme
- âœ… **Ä°ZÄ°N VERÄ°LEN**: Kritik bug'Ä± dÃ¼zelten spesifik kod
- âœ… **Ä°ZÄ°N VERÄ°LEN**: GÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± kapatan kod
- âœ… **Ä°ZÄ°N VERÄ°LEN**: System crash'i Ã¶nleyen kod

- âŒ **Ä°ZÄ°N VERÄ°LMEYEN**: Feature enhancement
- âŒ **Ä°ZÄ°N VERÄ°LMEYEN**: Code optimization "while we're at it"
- âŒ **Ä°ZÄ°N VERÄ°LMEYEN**: Refactoring during emergency
- âŒ **Ä°ZÄ°N VERÄ°LMEYEN**: Scope creep

## MANDATORY DOCUMENTATION - ZORUNLU DOKÃœMANTASYON

Her acil durum mÃ¼dahalesi detaylÄ± ÅŸekilde dokÃ¼mante edilir:

### ACÄ°L DURUM LOG FORMATI
```javascript
/*
 * EMERGENCY INTERVENTION LOG
 * =========================
 * Timestamp: 2024-01-15 14:30:22 UTC
 * Issue ID: EMERGENCY-2024-001
 * Severity: CRITICAL (System Crash)
 * 
 * PROBLEM DESCRIPTION:
 * Production database connection pool exhausted, causing complete
 * system unavailability. Users cannot access the application.
 * 
 * IMPACT ASSESSMENT:
 * - Affected users: ~10,000 active sessions
 * - Business impact: $5,000/hour revenue loss
 * - SLA breach: YES (99.9% uptime commitment)
 * 
 * EMERGENCY FIX APPLIED:
 * File: src/database/ConnectionManager.js
 * Lines before: 734 lines
 * Lines added: 23 lines (EMERGENCY EXCEPTION)
 * Lines after: 757 lines
 * 
 * CHANGES MADE:
 * 1. Added connection pool size validation
 * 2. Implemented connection recycling mechanism  
 * 3. Added emergency connection cleanup
 * 
 * REFACTORING SCHEDULED:
 * Deadline: 2024-01-16 14:30:22 UTC (24 hours)
 * Plan: Extract connection management to separate service
 * Estimated effort: 4 hours
 * 
 * SIGN-OFF:
 * Emergency authorized by: System Rules Override
 * Technical lead approval: PENDING
 * Refactoring assignment: PENDING
 */
```

### ACÄ°L DURUM RAPORU
Her acil durum sonrasÄ± detaylÄ± rapor oluÅŸturulur:

```
ğŸš¨ ACÄ°L DURUM MÃœDAHALE RAPORU

ğŸ“Š DURUM Ã–ZETÄ°:
   ğŸ¯ Sorun: [detaylÄ± problem aÃ§Ä±klamasÄ±]
   âš¡ Åiddet: [CRITICAL/HIGH severity]
   â±ï¸ Toplam downtime: [X minutes]
   ğŸ‘¥ Etkilenen kullanÄ±cÄ±: [X kullanÄ±cÄ±]

ğŸ”§ UYGULANAN Ã‡Ã–ZÃœM:
   ğŸ“ Hedef dosya: [dosya yolu]
   ğŸ“ Ã–nceki boyut: [X satÄ±r]
   â• Eklenen: [Y satÄ±r] (ACÄ°L Ä°STÄ°SNA)
   ğŸ“ Yeni boyut: [X+Y satÄ±r]

âš ï¸ KURAL Ä°STÄ°SNASI:
   ğŸš« Normal limit: 700 satÄ±r
   ğŸ“ˆ Mevcut durum: [X+Y satÄ±r] (Ä°STÄ°SNA AKTÄ°F)
   â° Ä°stisna sÃ¼resi: [deadline]
   
ğŸ”„ REFACTORING PLANI:
   ğŸ“… Deadline: [kesin tarih]
   ğŸ“‹ Plan: [detaylÄ± refactoring stratejisi]
   â±ï¸ Tahmini sÃ¼re: [X saat]
   
âœ… ACÄ°L DURUM SONLANDIRILDI
```

## REFACTORING ENFORCEMENT - ZORUNLU TEMÄ°ZLEME

### AUTOMATIC SCHEDULING
Her acil durum mÃ¼dahalesi otomatik olarak refactoring gÃ¶revi oluÅŸturur:

```javascript
function scheduleEmergencyRefactoring(emergency) {
    const refactoringTask = {
        id: `REFACTOR-${emergency.id}`,
        priority: 'CRITICAL',
        deadline: calculateRefactoringDeadline(emergency.severity),
        description: `Emergency refactoring for ${emergency.file}`,
        currentSize: emergency.newFileSize,
        targetSize: 'under 700 lines',
        strategy: generateRefactoringStrategy(emergency)
    };
    
    // Add to priority queue
    addToCriticalTasks(refactoringTask);
    
    // Set reminders  
    setRefactoringReminders(refactoringTask);
    
    return refactoringTask;
}
```

### REFACTORING DEADLINE CALCULATION
Acil durum ÅŸiddetine gÃ¶re refactoring deadline'larÄ±:

- **SYSTEM CRASH**: 24 saat iÃ§inde
- **CRITICAL FUNCTION**: 48 saat iÃ§inde  
- **SECURITY ISSUE**: 24 saat iÃ§inde
- **DATA RISK**: 48 saat iÃ§inde

### NON-COMPLIANCE CONSEQUENCES
Refactoring deadline kaÃ§Ä±rÄ±lÄ±rsa:

```
âš ï¸ REFACTORING DEADLINE KAÃ‡IRILDI!

ğŸš¨ DURUM: Kritik refactoring gÃ¶revi tamamlanmadÄ±
ğŸ“ Dosya: [emergency file path]
ğŸ“… Deadline: [missed deadline]
â° Gecikme: [X hours late]

ğŸ”’ AKTÄ°F KISITLAMALAR:
   âŒ Bu dosyaya yeni kod eklenemez
   âŒ Bu dosyayla ilgili yeni feature'lar bloke
   âŒ Proje build warning'leri aktif

ğŸ¯ Ä°VEDÄ° EYLEM GEREKLÄ°:
   1. Refactoring'i derhal tamamla
   2. Dosya boyutunu 700 satÄ±r altÄ±na indir  
   3. Test coverage'i doÄŸrula
   4. Code review yap
```

## EMERGENCY PREVENTION - Ã–NLEME STRATEJÄ°LERÄ°

### EARLY WARNING SYSTEM
Acil durumlarÄ± Ã¶nlemek iÃ§in erken uyarÄ± sistemi:

```javascript
function checkEmergencyRisk(project) {
    const riskFactors = {
        largeFiles: countFilesOverSize(600), // 600+ satÄ±rlÄ± dosyalar risk
        couplingLevel: assessModuleCoupling(),
        testCoverage: getTestCoverage(),
        techDebt: assessTechnicalDebt()
    };
    
    if (riskFactors.largeFiles > 5) {
        warn("EMERGENCY RISK: Ã‡ok fazla bÃ¼yÃ¼k dosya tespit edildi");
    }
    
    if (riskFactors.couplingLevel > 0.7) {
        warn("EMERGENCY RISK: YÃ¼ksek coupling, deÄŸiÅŸiklikler riskli");
    }
}
```

### PROACTIVE REFACTORING
Acil durumlarÄ± Ã¶nlemek iÃ§in proaktif refactoring:

- 600+ satÄ±rlÄ±k dosyalar iÃ§in otomatik uyarÄ±
- Coupling analizi ve risk assessment
- Regular maintenance window'larÄ±
- Technical debt tracking

## QUALITY GATES - ACÄ°L DURUM KALÄ°TE KONTROLÃœ

### PRE-EMERGENCY VALIDATION
Acil durum bile olsa minimum kalite kontrolleri yapÄ±lÄ±r:

- [ ] **Syntax check**: Kod Ã§alÄ±ÅŸÄ±r durumda mÄ±?
- [ ] **Import validation**: Yeni import'lar gereksiz deÄŸil mi?
- [ ] **Basic testing**: Temel functionality Ã§alÄ±ÅŸÄ±yor mu?
- [ ] **Security check**: GÃ¼venlik aÃ§Ä±ÄŸÄ± yaratmÄ±yor mu?

### POST-EMERGENCY VERIFICATION
Acil durum sonrasÄ± validation:

- [ ] **Fix effectiveness**: Sorun gerÃ§ekten Ã§Ã¶zÃ¼ldÃ¼ mÃ¼?
- [ ] **No regression**: BaÅŸka sorunlara neden olmadÄ± mÄ±?
- [ ] **Documentation complete**: DokÃ¼mantasyon tam mÄ±?
- [ ] **Refactoring scheduled**: Temizleme gÃ¶revi oluÅŸturuldu mu?

---

*Acil durumlar kaÃ§Ä±nÄ±lmazdÄ±r, ancak kontrollÃ¼ mÃ¼dahale ile hem sorunu Ã§Ã¶zer hem de sistem bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ koruruz. Her istisna geÃ§ici, her Ã§Ã¶zÃ¼m dokÃ¼mante, her mÃ¼dahale geri alÄ±nabilir olmalÄ±dÄ±r.*